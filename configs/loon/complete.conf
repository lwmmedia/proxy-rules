#!name=Loon Config - Corrected
#!desc=Fixed configuration for Loon
#!date=2025-01-15

[General]
ip-mode = v4-only
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,e.crashlytics.com
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
dns-server = system,119.29.29.29,114.114.114.114,223.5.5.5
allow-wifi-access = false
wifi-access-http-port = 7222
wifi-access-socks5-port = 7221
proxy-test-url = http://bing.com/generate_204
internet-test-url = http://wifi.vivo.com.cn/generate_204
test-timeout = 3
interface-mode = auto

[Proxy]
# Add your proxy servers here
# Example:
# SS-Server = ss,server.com,443,chacha20-ietf-poly1305,"password"
# VMess-Server = vmess,server.com,443,chacha20-poly1305,"uuid",transport:ws,path:/path,host:server.com

[Remote Proxy]
# Add remote proxy subscriptions here.
# The filters below will not work until you add a valid subscription.
# Example:
# My-Subscription = https://your-proxy-provider.com/sub?token=xxx,udp=true,fast-open=true,vmess-aead=true

[Proxy Group]
# Manual selection group
Available = select,ALL_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Available.png

# Streaming optimized - manual selection
YouTube = select,Available,US_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
Netflix = select,Available,US_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png

# Social media - auto select by speed
Telegram = url-test,SG_Filter,HK_Filter,interval=300,max-timeout=3000,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
Discord = url-test,US_Filter,EU_Filter,interval=300,max-timeout=3000,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Discord.png
Twitter = select,Available,US_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Twitter.png

# Tech services
Google = select,Available,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google.png
Apple = select,Available,DIRECT,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
Microsoft = select,Available,DIRECT,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png

# Region-based groups
HK = url-test,HK_Filter,interval=600,max-timeout=3000,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
TW = select,TW_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
SG = url-test,SG_Filter,interval=600,max-timeout=3000,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
JP = select,JP_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
US = select,US_Filter,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png

[Remote Filter]
ALL_Filter = NameRegex,FilterKey = ".*"
HK_Filter = NameRegex,FilterKey = "(?i)(港|HK|Hong)"
TW_Filter = NameRegex,FilterKey = "(?i)(台|TW|Tai)"
JP_Filter = NameRegex,FilterKey = "(?i)(日本|川日|东京|大阪|JP|Japan)"
SG_Filter = NameRegex,FilterKey = "(?i)(新加坡|坡|狮城|SG|Singapore)"
US_Filter = NameRegex,FilterKey = "(?i)(美|US|United States|America)"
EU_Filter = NameRegex,FilterKey = "(?i)(欧|EU|Europe|英|UK|德|DE|法|FR)"

[Rule]
# Streaming services
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/YouTube/YouTube.list,policy=YouTube,tag=YouTube,enabled=true
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Netflix/Netflix.list,policy=Netflix,tag=Netflix,enabled=true

# Social platforms
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Telegram/Telegram.list,policy=Telegram,tag=Telegram,enabled=true
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Discord/Discord.list,policy=Discord,tag=Discord,enabled=true
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Twitter/Twitter.list,policy=Twitter,tag=Twitter,enabled=true

# Global tech services
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Google/Google.list,policy=Google,tag=Google,enabled=true
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Apple/Apple.list,policy=Apple,tag=Apple,enabled=true
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Microsoft/Microsoft.list,policy=Microsoft,tag=Microsoft,enabled=true

# China direct
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/China/China.list,policy=DIRECT,tag=China,enabled=true

# Fallback
GEOIP,CN,DIRECT
# FINAL is set to DIRECT as a safe default. Change to FINAL,Available after adding proxies.
FINAL,DIRECT

[Rewrite]

[Script]

[Mitm]
skip-server-cert-verify = false